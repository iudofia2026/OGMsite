/**
 * Performance Optimization CSS - Based on Professional Standards
 *
 * This file implements the performance optimization standards from
 * /src/config/professionalOptimization.js for production-ready deployment
 */

/* =============================================================================
   CRITICAL RENDERING PATH OPTIMIZATION
============================================================================= */

/* Critical CSS Inlined for Above-the-Fold Content */
.critical-layout {
    /* Essential layout styles for hero section */
    display: block;
    position: relative;
    overflow: hidden;
}

.critical-typography {
    /* Essential font loading to prevent layout shift */
    font-family: var(--font-primary-serif);
    font-display: swap;
    font-weight: 900;
}

/* =============================================================================
   FONT LOADING OPTIMIZATION
============================================================================= */

/* Preload Critical Fonts - Add to HTML head */
/*
<link rel="preload" href="https://fonts.gstatic.com/s/playfairdisplay/v36/nuFiD-vYSZviVYUb_rj3ij__anPXBYf9lWAe7GrtJWY.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="https://fonts.gstatic.com/s/inter/v13/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZhrib2Bg-4.woff2" as="font" type="font/woff2" crossorigin>
*/

/* Font Display Optimization */
@font-face {
    font-family: 'Playfair Display';
    font-display: swap; /* Prevents invisible text during font load */
}

@font-face {
    font-family: 'Inter';
    font-display: swap;
}

@font-face {
    font-family: 'Crimson Pro';
    font-display: swap;
}

/* =============================================================================
   IMAGE OPTIMIZATION
============================================================================= */

/* Optimized Background Image Loading */
.bg-optimized {
    /* Prevent layout shift during image load */
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;

    /* Performance optimization */
    will-change: transform; /* Only when actively animating */
    contain: layout style paint;

    /* Modern image formats fallback */
    background-image:
        url('/images/backgrounds/agave.webp'), /* Modern format */
        url('/images/backgrounds/agave.png');   /* Fallback */
}

/* Lazy Loading for Non-Critical Images */
.lazy-load {
    opacity: 0;
    transition: opacity 0.3s ease;
}

.lazy-load.loaded {
    opacity: 1;
}

/* =============================================================================
   ANIMATION PERFORMANCE
============================================================================= */

/* GPU Acceleration for Smooth Animations */
.gpu-accelerated {
    will-change: transform;
    transform: translateZ(0); /* Force GPU layer */
    backface-visibility: hidden;
}

/* Optimized Scroll Animations */
.scroll-optimized {
    /* Use transform instead of changing layout properties */
    transform: translate3d(0, 0, 0);

    /* Reduce repaints */
    will-change: transform;

    /* Smooth animation timing */
    animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
}

/* Reduce Motion for Accessibility */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
}

/* =============================================================================
   MOBILE OPTIMIZATION
============================================================================= */

/* Touch Target Optimization */
.touch-target {
    min-height: 44px; /* iOS/Android minimum touch target */
    min-width: 44px;
    padding: 12px;
}

/* Prevent Horizontal Scroll on Mobile */
.mobile-optimized {
    max-width: 100vw;
    overflow-x: hidden;
}

/* iOS Safari Viewport Fix */
.ios-vh-fix {
    height: 100vh;
    height: -webkit-fill-available;
}

/* =============================================================================
   ACCESSIBILITY OPTIMIZATIONS
============================================================================= */

/* Focus Management */
.focus-visible {
    outline: 2px solid #d4af37;
    outline-offset: 2px;
}

/* Skip to Content Link */
.skip-link {
    position: absolute;
    top: -40px;
    left: 6px;
    background: #000;
    color: #fff;
    padding: 8px;
    text-decoration: none;
    z-index: 1000;
    transition: top 0.3s ease;
}

.skip-link:focus {
    top: 6px;
}

/* High Contrast Mode Support */
@media (prefers-contrast: high) {
    .hero-title {
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 1);
        background: #fff !important;
        -webkit-text-fill-color: #000 !important;
        color: #000 !important;
    }
}

/* =============================================================================
   PRODUCTION OPTIMIZATIONS
============================================================================= */

/* Remove Debug Styles in Production */
.development-only {
    /* These styles are stripped in production builds */
    border: 2px dashed red;
    background: rgba(255, 0, 0, 0.1);
}

/* Critical CSS Purging Safelist */
/*
Safelist classes for PurgeCSS:
- hero-*
- bg-img-*
- text-ani
- bottle*
- section-*
- scroll-*
- critical-*
- gpu-*
- mobile-*
*/

/* =============================================================================
   CORE WEB VITALS OPTIMIZATION
============================================================================= */

/* Largest Contentful Paint (LCP) Optimization */
.lcp-optimized {
    /* Ensure hero images load quickly */
    content-visibility: auto;
    contain-intrinsic-size: 100vh;
}

/* Cumulative Layout Shift (CLS) Prevention */
.layout-stable {
    /* Reserve space for dynamic content */
    min-height: 100vh;
    aspect-ratio: 16/9; /* For images */
}

/* First Input Delay (FID) Optimization */
.interaction-ready {
    /* Ensure interactive elements are immediately responsive */
    pointer-events: auto;
    user-select: auto;
}

/* =============================================================================
   BROWSER COMPATIBILITY
============================================================================= */

/* CSS Grid Fallback for Older Browsers */
@supports not (display: grid) {
    .grid-container {
        display: flex;
        flex-wrap: wrap;
    }
}

/* Modern Features with Fallbacks */
@supports (backdrop-filter: blur(10px)) {
    .modern-blur {
        backdrop-filter: blur(10px);
    }
}

@supports not (backdrop-filter: blur(10px)) {
    .modern-blur {
        background: rgba(0, 0, 0, 0.8);
    }
}

/* =============================================================================
   DEVELOPMENT vs PRODUCTION
============================================================================= */

/* Development Mode Helpers */
@media screen {
    .dev-helper {
        /* Only show in development */
        display: block;
    }
}

@media print {
    .dev-helper {
        display: none !important;
    }
}